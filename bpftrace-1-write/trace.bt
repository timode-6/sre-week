// Your code goes here
#!/usr/bin/env bpftrace

#include <linux/sched.h>

BEGIN
{
    printf("Tracing disk writes for process 'main'...\n");
}

tracepoint:syscalls:sys_enter_write
/comm == "main"/
{
    @stacks[ustack] = count();
    @bytes[ustack] = sum(args->count);
}

END
{
    printf("Disk write statistics:\n");
    print(@stacks);
    printf("\nBytes written per stack:\n");
    print(@bytes);
}